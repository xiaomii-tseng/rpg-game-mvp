/* src/app/features/combat/combat-view.component.scss */

// 1. 整體容器與版面
.combat-container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  padding: 20px;
  background-color: #222;
  color: white;
  gap: 10px;
  max-width: 600px; // 建議加上最大寬度，避免電腦版太寬
  margin: 0 auto;   // 讓容器置中
  box-sizing: border-box; // 確保 padding 不會撐破寬度
}

// 2. 玩家與怪物區塊
.unit-area {
  position: relative; // 讓裡面的絕對定位元素以這裡為基準
  border: 1px solid #555;
  padding: 10px;
  border-radius: 8px;
  background: rgba(0, 0, 0, 0.5);
  margin-bottom: 5px;
  
  h2, h3 {
    margin: 0 0 5px 0;
    font-size: 1.2em;
    text-align: center;
  }
}

// 3. 裝備與數值顯示
.equipment-slot, .player-stats {
  font-size: 0.9em;
  margin-bottom: 3px;
  text-align: center;
}

// ⭐ 4. 狀態條 (修正重點：確保數字顯示)
.bar-container {
  width: 100%;
  height: 16px;           // 高度微調
  background: #000;       // 底色 (扣血後的黑色部分)
  margin-bottom: 3px;
  border-radius: 4px;
  overflow: hidden;
  position: relative;     // 定位基準
  border: 1px solid #555; // 加個邊框比較清楚
  
  // 關鍵：使用 Flexbox 讓文字絕對置中
  display: flex;
  align-items: center;
  justify-content: center;

  // 文字樣式
  .text {
    position: relative;   // 改回 relative，讓它參與 Flex 置中
    z-index: 10;          // ⭐ 層級最高，浮在血條上面
    font-size: 11px;
    font-weight: bold;
    color: #fff;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.8); // 黑框，確保在任何底色都清楚
    line-height: 1;
  }

  // 顏色條 (變成背景圖層)
  .hp-bar, .mp-bar, .shield-bar {
    position: absolute;   // ⭐ 絕對定位，不佔空間
    left: 0;
    top: 0;
    height: 100%;
    z-index: 1;           // ⭐ 層級較低，在文字下面
    transition: width 0.3s ease-out; // 加一點動畫緩衝
  }
}

// 各種條的顏色
.hp-bar { background: #e74c3c; }
.mp-bar { background: #3498db; }
.shield-bar { background: #bdc3c7; }
.shield-bar.broken { background: #555; }

.mp-container { margin-top: 5px; }

// XP 條 (通常比較細)
.xp-container {
  height: 8px;
  margin-bottom: 5px;
  border: 1px solid #666;
  
  // 覆寫上面 bar-container 的設定
  .text { display: none; } // 如果太細不想顯示數字，可以隱藏
  
  .xp-bar {
    position: absolute;
    left: 0; top: 0; height: 100%; z-index: 1;
    background: #f1c40f;
    box-shadow: 0 0 5px #f1c40f;
    transition: width 0.3s;
  }
}

// 5. 中間戰鬥紀錄區
.log-area {
  flex: 1;
  overflow-y: auto;
  border: 1px dashed #444;
  padding: 10px;
  font-size: 14px;
  color: #ccc;
  max-height: 150px;
  
  // 自定義卷軸
  &::-webkit-scrollbar { width: 5px; }
  &::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
  &::-webkit-scrollbar-thumb { background: #7f8c8d; border-radius: 4px; }
}

// 6. 按鈕區塊
.actions {
  margin-top: 5px;
  display: flex;
  flex-direction: column; 
  gap: 5px;
}

.combat-btns {
  display: flex;
  gap: 5px;
  button { flex: 1; }
}

button {
  flex: 1;
  padding: 8px 5px;
  font-size: 14px;        // 字體適中
  cursor: pointer;
  background: #3498db;
  color: white;
  border: none;
  border-radius: 4px;
  
  &:disabled { background: #555; cursor: not-allowed; opacity: 0.7; }
  
  &.skill-btn { background: #e74c3c; }
  &.guard-btn { background: #2ecc71; }
  &.reset-btn { 
    background: #e67e22; 
    width: 100%;
    padding: 10px;
  }
}

// 7. 背包與物品區
.inventory-area {
  margin-top: 10px;
  padding-top: 10px;
  
  h4 { margin: 0 0 5px 0; font-size: 1em; }
}

.item-list {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  max-height: 200px;
  overflow-y: auto;
  padding: 10px;
  border: 1px solid #444;
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;

  &::-webkit-scrollbar { width: 8px; }
  &::-webkit-scrollbar-track { background: #2c3e50; border-radius: 4px; }
  &::-webkit-scrollbar-thumb { background: #7f8c8d; border-radius: 4px; }
}

.item-card {
  background: #444;
  padding: 5px 10px;
  border-radius: 4px;
  border: 1px solid #666;
  font-size: 12px;
  cursor: pointer;
  transition: transform 0.1s;
  
  &.common { border-color: #bdc3c7; color: #ecf0f1; }
  &.rare { border-color: #f1c40f; color: #f1c40f; box-shadow: 0 0 5px #f1c40f; }

  &:hover { transform: scale(1.05); background-color: #555; }
  &:active { transform: scale(0.95); }

  .item-stat { margin-left: 5px; color: #aaa; }
  .item-stat.heal { color: #2ecc71; font-weight: bold; }
}

// 8. 狀態文字與特效 (合併整理)
.status-text {
  position: absolute;
  width: 100%;
  left: 0;
  text-align: center;
  z-index: 20;
  pointer-events: none;
  font-weight: bold;

  &.charging {
    top: 5px;
    color: #ff5252;
    font-size: 14px;
    text-shadow: 0 0 3px black;
    animation: shake 0.5s infinite;
  }

  &.broken {
    bottom: 30px;
    font-size: 24px;
    color: #f1c40f;
    text-shadow: 2px 2px 0 #c0392b;
    transform: rotate(-5deg);
  }
}

.item-stat {
  margin-left: 5px;
  color: #aaa;

  &.heal { color: #2ecc71; font-weight: bold; } /* 綠 */
  &.mana { color: #3498db; font-weight: bold; } /* ⭐ 藍 */
}

// 動畫定義
@keyframes shake {
  0% { transform: translate(0, 0); }
  25% { transform: translate(-2px, 0); }
  75% { transform: translate(2px, 0); }
  100% { transform: translate(0, 0); }
}